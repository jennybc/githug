---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# githug

The goal of githug is to wrap you in the warm embrace of Git ðŸ¤—, from the comfort of R.

*This a reboot of an earlier effort, which lives on in [branch `first-draft` ](https://github.com/jennybc/githug/tree/first-draft). That branch includes a function `githug_init()` to connect a new or existing R project (usually a RStudio Project) to a newly created GitHub remote. Currently plodding my way back to that level of functionality.*

## Installation

You can install githug from github with:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("jennybc/githug")
```

## Example

Create a new Git repository and set local config variables for user and email.

```{r}
#library(githug)
devtools::load_all(".")

repo <- git_init(tempfile("githug-example-"))
setwd(repo)
git_config_local(user.name = "louise", user.email = "louise@example.org")
```

Create two files and inspect Git status.

```{r}
setwd(repo) ## necessary because knitr resets wd in every chunk :(

write("Are these girls real smart or real real lucky?", "max.txt")
write("You get what you settle for.", "louise.txt")
git_status()
```

Commit with `all = TRUE` to automatically accept all current changes.

```{r}
setwd(repo) ## necessary because knitr resets wd in every chunk :(

git_commit(all = TRUE,
           message = "Brains'll only get you so far and luck always runs out.")
```

Add new file and commit it. Inspect commit history. 

```{r}
setwd(repo) ## necessary because knitr resets wd in every chunk :(

write("Did I hear somebody say \"Peaches\"?", "jimmy.txt")
git_commit("jimmy.txt", message = "That's the code word. I miss you, Peaches.")
git_log()
```

Uncommit, i.e. leave files as they are, but go back to parent of current commit.

```{r}
setwd(repo) ## necessary because knitr resets wd in every chunk :(

git_uncommit()
git_log()
```

Verify files and staging are OK. Unstage a file.

```{r}
setwd(repo) ## necessary because knitr resets wd in every chunk :(

git_status()
list.files()
git_unstage("jimmy.txt")
git_status()
```

## Overview of functions

```{r include = FALSE}
fxn_table <-
"fxn,description
git_config(), Get and set Git configuration variables
git_init(), Create a new repository
git_status(), Get status of all files w/r/t Git
git_log(), Get commit history
git_stage(), Stage (changes to) a path for next commit
git_add(), Synonym for git_stage()
git_unstage(), Unstage (changes to) a path
git_commit(), Make a commit
git_uncommit(), Undo a Git commit but leave files alone
as.git_repository(), Open a Git repo in the style of the `git2r` package
"
```

```{r as.is = TRUE, echo = FALSE}
knitr::kable(read.csv(text = fxn_table))
```

*to be replaced by a proper test coverage badge* 

```{r}
Sys.time()
git2r::repository(".")
covr::package_coverage(".")
```
